
<h1 id="start">Tutorial 2: Building a template query.</h1>

      <p><i>This tutorial introduces the use of the QueryBuilder to build
      a query. It will then show you how to save this query as a
      template.</i></p>

    <p>You can use the QueryBuilder:/p>

      <ul>
        <li><p>to construct your own data mining queries
      across the multiple integrated data sources,</p></li>

        <li><p>to modify existing template queries or</p></li>

        <li><p>to create your own template queries.</p></li>
      </ul>

      <p>The QueryBuilder interface enables you to browse through
    classes and fields of the data model, selecting those that you
    wish to constrain and those that you wish to include in your
    results.</p>


      <p>The main FlyMine QueryBuilder page is composed of 3 sections:</p>

      <ul>
        <li><p><b>The model browser (left)</b> allows you to browse
      through the FlyMine data model, selecting the classes that
      contain the objects you require. Depending on the starting class
      you will be able to navigate to other classes as defined by the
      references between the classes. In other words, to combine
      classes containing the objects you require, you find a path
      through the classes that link together the information you
      require. Within the model browser, classes that can be accessed
      from a parent class (i.e. are linked to the parent class through
      a reference) are shown as fields within that class.  For each
      field within the model browser there is a 'SHOW' and a
      'CONSTRAIN' option. These are used to either select a
      field to show in the results output or to constrain in the
      constraints list.</p></li>

        <li><p><b>The constraints list (right)</b> allows you to
      specify the constraints you wish to apply to particular classes
      and fields. A constraint is like a filter - you filter out a
      subset of the objects in a class which have certain
      characteristics (defined by the constraint). To apply a
      constraint to a field, navigate to the field in the model
      browser and click on the 'constrain' button next to it. This
      will add the field to the constraints list and bring up a box in
      which you specify your constraint.</p></li>

        <li><p>Initially, <b>the output fields list (bottom)</b> will
      say 'No fields selected for output'. The output fields list
      shows all fields that you have selected to show in your
      results. To select a field to show in the results output you
      press 'SHOW' next to the field. The order of fields in the
      output fields list can be changed using the arrows or by
      dragging them. Fields can be deleted from the output fields list
      using the x. Fields that have been selected for output will
      appear in a blue box in the model browser and constraint
      list.</p></li>

    </ul>

      <img alt="[QB-template1.png]" class="inlinegraphic" src="QB-template1.png"/>


      <p>In the next steps, we will change the current
     query to retrieve all genes on the 4th chromosome.</p>

      <ul>
        <li><p>Click on 'Current query' in the top menu bar
         to return to the QueryBuilder.</p></li>

        <li><p>The right hand side summarises constraints in
         the current query. Note the constraint on Gene symbol to be
         'zen'. Clicking on the red cross next to 'symbol' will delete
         this constraint.</p></li>

        <li><p>To constrain the current query for genes on
         the 4th chromosome, click on the + sign next to 'chromosome'
         in the column on the left. Click on 'CONSTRAIN' next to
         'identifier' (under 'chromosome'). This brings up a
         'Constrain' section to the right (you might have to scroll
         down to view it). You can enter or select a value for the
         chromosome identifier from the drop-down menu: the identifier
         for the 4th chromosome is '4'. Click 'Add to query' next to
         the drop-down menu.</p></li>
      </ul>

      <img alt="[QB_template2.png]" class="inlinegraphic" src="QB_template2.png"/>

      <ul>
        <li><p>Now we need to constrain the query to return
         only genes from <i>D. melanogaster</i>. Click
         on the + sign next to 'organism' in the column on the
         left. Next, click on 'CONSTRAIN' next to 'name' (under
         'organism'). This brings up a 'Constrain' section to the
         right. Select 'Drosophila melanogaster' and click on 'Add to
         query' next to the drop-down menu.</p>
</li>
        <li><p>Finally, we will change the current query so
         that it also returns the FBgn number. To make the FBgn number
         appear on the result page, click on 'SHOW' next to
         'organismDbId' under 'Gene'. 'organismDbId' will now appear
         in blue and can be find in the output section below. The
         order of the columns can be changed by clicking and dragging
         the output boxes. Scroll down and click 'Show results' to run
         the query again.</p>
</li>
      </ul>

      <img alt="[QB-template3.png]" class="inlinegraphic" src="QB-template3.png"/>

      <p>To build a new query from scratch, access the FlyMine
    QueryBuilder at the bottom of the FlyMine home page or by choosing
    a query starting point at the bottom of a dta category page.</p>


      <p>Any query that has been built using the FlyMine QueryBuilder
    can be saved as a template query, as long as it includes at least
    one editable constraint. In order to build a template you need to
    be logged-in to FlyMine. Templates that you create yourself are
    saved to your 'MyMine'.</p>

    <p> After building the query 'Show all genes on the 4th chromosome
    of <i>Drosophila melanogaster</i>' while being logged-in, scroll
    down and click on 'Start building a template query'.</p>

      <img alt="[buildtemp-start.png]" class="inlinegraphic" src="buildtemp-start.png"/>

      <p>In order to save a query as a template it is necessary to
        define which of the constraints in the query will be editable
        in the template (there must be at least one 'editable'
        constraint in the query). To make a constraint editable
        within a template, click on the lock next to the constraint: A
        field with 'Template constraint settings' will appear in the
        right column. Click in the tick-box next to 'Editable'. At the
        same time, it is possible to add a label to the editable
        constraint (optional) to clarify what it is by typing in a
        label in 'Constraint label'. Click on the 'Update' button in
        this field. The label will appear on the template page after
        creating the template (see below).</p>

      <img alt="[buildtemp-edit.png]" class="inlinegraphic" src="buildtemp-edit.png"/>

      <p>An editable constraint will have an open lock in the
   constraint list, whereas the lock of a constraint that cannot be
   edited will appear locked. The label of the editable constraint
   will appear below the constraint, in italics.</p>

      <img alt="[buildtemp-label.png]" class="inlinegraphic" src="buildtemp-label.png"/>

      <p>If no label was added after a constraint was made editable,
    'no label' will appear under the constraint. Clicking on 'no
    label' allows you to add a label. Click on 'Update' to implement
    the change.</p>

      <img alt="[buildtemp-nolabel.png]" class="inlinegraphic" src="buildtemp-nolabel.png"/>

      <p>Each new template requires a name and a description. The
    description will appear on the template page and in your list of
    template queries, after creating the template (see
    below). Therefore, it should provide as much information as
    possible about what the template will do. Moreover, it should be
    distinguishable from other template queries. After filling the
    'Name' and 'Description' boxes, click on 'Update settings' below
    the boxes.</p>

      <img alt="[buildtemp-name.png]" class="inlinegraphic" src="buildtemp-name.png"/>

      <p>Before creating a template, preview the template and make
    any changes, if necessary. To save this query as a template, click
    on 'Save template'.</p>

      <img alt="[buildtemp-preview.png]" class="inlinegraphic" src="buildtemp-preview.png"/>

      <p>You will be able to view and run this template from the
    'Saved templates' tab of your 'MyMine'. Access your MyMine page
    via the top menu bar on every FlyMine page.  For each template
    there are a set of actions, 'Run', 'Edit' and 'Export'. 'Run' will
    run the template query and give you a results paage.  'Edit'
    allows you to edit the template query. 'Export' will export the
    template in xml format.  In addition clicking on the star next to
    a template name (so that it turns yellow) will add that template
    to the 'Favourite templates' tab of your MyMine.</p>

      <img alt="[buildtemp-history.png]" class="inlinegraphic" src="buildtemp-history.png"/>

      <p>- The template page can be viewed and run from the 'Saved
    Templates' tab of your MyMine page.</p>

      <img alt="[buildtemp-template.png]" class="inlinegraphic" src="buildtemp-template.png"/>

      <p style="">- The template can be exported in xml format.</p>

      <img alt="[buildtemp-export.png]" class="inlinegraphic" src="buildtemp-export.png"/>

