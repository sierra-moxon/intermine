
<project name="testmodel-webservice-test" default="default" basedir="."
  xmlns:imtestsproj="http://www.intermine.org/ns/im-tests-proj/1"
  xmlns:task="http://www.intermine.org/ns/im-task-proj/1">
  
  <description>build, test, package testmodel-webservice-test</description>
  
  <import file="../../../imbuild/tests.xml"/>
  <import file="../../../imbuild/task.xml"/>

  <target name="-build-db" depends="-init-task-xml" unless="no.test.init">
    <!-- put onto the task classpath, hmm -->
    <copy file="${user.home}/${intermine.properties.file}"
          tofile="${build.task.dir}/intermine.properties"/>
    <copy file="${default.intermine.properties.file}"
          tofile="${build.task.dir}/default.intermine.properties"/>
    <task:build-db osname="${objectstore.name}" dbname="${db.name}" model="${model.name}"/>
  </target>
  
  <target name="-redeploy-webservice">
    <ant antfile="../main/build.xml" target="remove-webapp" inheritAll="false"/>
    <ant antfile="../main/build.xml" target="release-webapp" inheritAll="false"/>
  </target>
  
  <target name="init-test" depends="tests.init-test, -copy-intermine-properties, -build-db, -redeploy-webservice"/>
  
  <target name="-copy-intermine-properties">
    <copy file="${user.home}/${intermine.properties.file}"
          tofile="${build.test.resources.dir}/intermine.properties"/>
    <copy file="${default.intermine.properties.file}"
          tofile="${build.test.resources.dir}/default.intermine.properties"/>
  </target>
  
</project>

