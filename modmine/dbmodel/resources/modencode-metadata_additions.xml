<?xml version="1.0"?>
<classes>
<!-- FEATURES -->

<!-- Extension of classes defined elsewhere, e.g. 
     bio/core/genomic_additions.xml
     bio/sources/so/so_additions.xml 
-->

<class name="LocatedSequenceFeature" is-interface="true">
  <attribute name="featureType" type="java.lang.String" />
  <attribute name="score" type="java.lang.Double" />
  <attribute name="scoreType" type="java.lang.String" />
  <attribute name="predictionStatus" type="java.lang.String" />
  <reference name="scoreProtocol" referenced-type="Protocol" />
  <collection name="submissions" referenced-type="Submission" reverse-reference="features" />
  <collection name="featureEvidence" referenced-type="LocatedSequenceFeature" reverse-reference="supportedFeatures" />
  <collection name="supportedFeatures" referenced-type="LocatedSequenceFeature" reverse-reference="featureEvidence" />  
</class>
<class name="ThreePrimeUTR" is-interface="true">
  <collection name="CDSs" referenced-type="CDS" reverse-reference="threePrimeUTRs" />    
  <collection name="polyASignalSequences" referenced-type="PolyASignalSequence" reverse-reference="threePrimeUTRs" />    
</class>
<class name="CDS" is-interface="true">
  <collection name="threePrimeUTRs" referenced-type="ThreePrimeUTR" reverse-reference="CDSs"/>
</class>
<class name="ExonRegion" extends="Region" is-interface="true">
  <collection name="expressionLevels" referenced-type="ExpressionLevel" reverse-reference="exonRegion"/>
</class>
<class name="MRNA" is-interface="true">
  <collection name="startCodons" referenced-type="StartCodon" reverse-reference="mRNA"/>
  <collection name="stopCodons" referenced-type="StopCodon" reverse-reference="mRNA"/>
  <collection name="stopCodons" referenced-type="StopCodon" reverse-reference="mRNA"/>
</class> 
<class name="EST" is-interface="true">
  <collection name="overlappingESTSets" referenced-type="OverlappingESTSet" reverse-reference="ESTs" />
</class>
<class name="MiRNA" is-interface="true">
  <collection name="expressionLevels" referenced-type="ExpressionLevel" reverse-reference="miRNA"/>
</class>
<class name="Exon" is-interface="true">
  <collection name="expressionLevels" referenced-type="ExpressionLevel" reverse-reference="exon"/>
</class>
<class name="Intron" is-interface="true">
  <collection name="expressionLevels" referenced-type="ExpressionLevel" reverse-reference="intron"/>
</class>


<!-- these references should be checked: maybe collections? -->
<class name="Transcript" is-interface="true">
  <collection name="SL1AcceptorSites" referenced-type="SL1AcceptorSite" reverse-reference="transcripts" />
  <collection name="SL2AcceptorSites" referenced-type="SL2AcceptorSite" reverse-reference="transcripts" />
  <collection name="TSSs" referenced-type="TSS" reverse-reference="transcripts" />
<!--   <collection name="expressionLevels" referenced-type="ExpressionLevel" reverse-reference="transcript"/>
-->
</class>
<class name="Gene" is-interface="true">
  <attribute name="source" type="java.lang.String" />
</class>
<!-- PolyASite is already in so_additions extending 'GenePart', not in miso -->
<class name="PolyASite" is-interface="true">
  <reference name="threePrimeRACEClone" referenced-type="ThreePrimeRACEClone" reverse-reference="polyASite"/>        
</class>


<!-- NEW FEATURE classes for modENCODE -->
<class name="CDNA" extends="Region" is-interface="true"/>
<class name="NaturalTransposableElement" extends="Region" is-interface="true"/>
<class name="StopCodon" extends="Codon" is-interface="true">
  <reference name="mRNA" referenced-type="MRNA" reverse-reference="stopCodons"/>        
</class>
<class name="StartCodon" extends="Codon" is-interface="true">
  <reference name="mRNA" referenced-type="MRNA" reverse-reference="startCodons"/>        
</class>
<class name="HistoneBindingSite" extends="ProteinBindingSite" is-interface="true"/>
<class name="TranscriptRegion" extends="Region" is-interface="true">
</class>
<class name="CopyNumberVariation" extends="SequenceVariant" is-interface="true"/>
<class name="ThreePrimeRACEClone" extends="Region" is-interface="true">
  <reference name="polyASite" referenced-type="PolyASite" reverse-reference="threePrimeRACEClone"/>            
  <reference name="threePrimeRST" referenced-type="ThreePrimeRST" reverse-reference="threePrimeRACEClone"/>        
</class>
<class name="ThreePrimeRST" extends="Region" is-interface="true">
  <reference name="threePrimeRACEClone" referenced-type="ThreePrimeRACEClone" reverse-reference="threePrimeRST"/>            
  <reference name="threePrimeUST" referenced-type="ThreePrimeUST" reverse-reference="threePrimeRST"/>            
</class>
<class name="ThreePrimeUST" extends="Region" is-interface="true">
 <reference name="threePrimeRST" referenced-type="ThreePrimeRST" reverse-reference="threePrimeUST"/>        
</class>

<class name="OverlappingESTSet" extends="Region" is-interface="true">
  <collection name="ESTs" referenced-type="EST" reverse-reference="overlappingESTSets" />
<!-- 
  <reference name="gene" referenced-type="Gene" reverse-reference="overlappingESTSet" />
  <reference name="mRNA" referenced-type="MRNA" reverse-reference="overlappingESTSet" />
  <reference name="transcriptRegion" referenced-type="TranscriptRegion" reverse-reference="overlappingESTSet"/>
-->
</class>
<class name="PolyASignalSequence" extends="Region" is-interface="true">
  <collection name="threePrimeUTRs" referenced-type="ThreePrimeUTR" reverse-reference="polyASignalSequences"/>
</class>
<class name="SL1AcceptorSite" extends="Region" is-interface="true">
  <collection name="transcripts" referenced-type="Transcript" reverse-reference="SL1AcceptorSites"/>
</class>
<class name="SL2AcceptorSite" extends="Region" is-interface="true">
  <collection name="transcripts" referenced-type="Transcript" reverse-reference="SL2AcceptorSites"/>
</class>

<!-- these should be actually the same class -->
<class name="TSS" extends="TranscriptionStartSite" is-interface="true">
  <collection name="transcripts" referenced-type="Transcript" reverse-reference="TSSs"/>
</class>

<!-- OTHER modENCODE classes -->   

<class name="ExpressionLevel" is-interface="true">
  <attribute name="name" type="java.lang.String" />
  <attribute name="value" type="java.lang.Double" />
  <attribute name="readCount" type="java.lang.Integer" />
  <attribute name="dcpm" type="java.lang.Double" />
  <attribute name="dcpmBases" type="java.lang.Integer" />
  <attribute name="transcribed" type="java.lang.String" />
  <attribute name="predictionStatus" type="java.lang.String" />
  
  <reference name="miRNA" referenced-type="MiRNA" reverse-reference="expressionLevels"/>
<!--   <reference name="transcript" referenced-type="Transcript" reverse-reference="expressionLevels"/>
-->
  <reference name="exon" referenced-type="Exon" reverse-reference="expressionLevels"/>
  <reference name="exonRegion" referenced-type="ExonRegion" reverse-reference="expressionLevels"/>
  <reference name="intron" referenced-type="Intron" reverse-reference="expressionLevels"/> 
</class>



<class name="Project" is-interface="true">
  <attribute name="name" type="java.lang.String" />
  <attribute name="title" type="java.lang.String" />
  <attribute name="surnamePI" type="java.lang.String" />
  <attribute name="namePI" type="java.lang.String" />
  <attribute name="url" type="java.lang.String" />
  <collection name="labs" referenced-type="Lab" reverse-reference="project" />
  <collection name="experiments" referenced-type="Experiment" reverse-reference="project" />
  <collection name="submissions" referenced-type="Submission" reverse-reference="project" />
  <collection name="organisms" referenced-type="Organism" />
</class>

<class name="Lab" extends="DataSource" is-interface="true">
  <attribute name="name" type="java.lang.String" />
  <attribute name="surname" type="java.lang.String" />
  <attribute name="affiliation" type="java.lang.String" />
  <reference name="project" referenced-type="Project" reverse-reference="labs" />
  <collection name="submissions" referenced-type="Submission" reverse-reference="lab" />
</class>

<class name="Experiment" is-interface="true">
  <attribute name="name" type="java.lang.String" />
  <reference name="project" referenced-type="Project" reverse-reference="experiments" />
  <collection name="submissions" referenced-type="Submission" reverse-reference="experiment" />
</class>

<class name="Submission" extends="DataSet" is-interface="true">
  <attribute name="title" type="java.lang.String" />
  <attribute name="description" type="java.lang.String" />
  <attribute name="design" type="java.lang.String" />
  <attribute name="qualityControl" type="java.lang.String" />
  <attribute name="replicate" type="java.lang.String" />
  <attribute name="experimentDate" type="java.util.Date" />
  <attribute name="publicReleaseDate" type="java.util.Date" />     
  <attribute name="embargoDate" type="java.util.Date" />     
  <attribute name="DCCid" type="java.lang.Integer" />     
  <attribute name="experimentType" type="java.lang.String" />     
  <reference name="organism" referenced-type="Organism" /> 
  <reference name="publication" referenced-type="Publication"/>
<!-- <attribute name="fileFormat" type="java.lang.String"/> -->
    <reference name="experiment"
      referenced-type="Experiment"
      reverse-reference="submissions" />
    <reference name="lab"
      referenced-type="Lab"
      reverse-reference="submissions" />
    <reference name="project"
      referenced-type="Project"
      reverse-reference="submissions" />
    <collection name="appliedProtocols"
      referenced-type="AppliedProtocol"
      reverse-reference="submission" />
    <collection name="protocols"
      referenced-type="Protocol"
      reverse-reference="submissions" />
    <collection name="submissionData"
      referenced-type="SubmissionData"
      reverse-reference="submission" />
    <collection name="experimentalFactors"
      referenced-type="ExperimentalFactor"
      reverse-reference="submissions" />

    <collection name="properties" referenced-type="SubmissionProperty" reverse-reference="submissions"/>
    <collection name="antibodies" referenced-type="Antibody"/>
    <collection name="developmentalStages" referenced-type="DevelopmentalStage"/>
    <collection name="cellLines" referenced-type="CellLine"/>
    <collection name="strains" referenced-type="Strain"/>
    <collection name="tissues" referenced-type="Tissue"/>
    <collection name="arrays" referenced-type="Array"/>
    <collection name="features" referenced-type="LocatedSequenceFeature" reverse-reference="submissions"/>
    <collection name="databaseRecords" referenced-type="DatabaseRecord" reverse-reference="submissions"/>
    <collection name="resultFiles" referenced-type="ResultFile" reverse-reference="submission"/>
    <collection name="relatedSubmissions" referenced-type="Submission"/>
  </class>

  <class name="ExperimentalFactor"
    is-interface="true">
    <attribute name="name" type="java.lang.String" />
    <attribute name="type" type="java.lang.String" />
    <reference name="property" referenced-type="SubmissionProperty"/>
    <collection name="submissions"
      referenced-type="Submission"
      reverse-reference="experimentalFactors" />
  </class>

  <class name="DatabaseRecord" is-interface="true">
    <attribute name="database" type="java.lang.String"/>
    <attribute name="description" type="java.lang.String"/>
    <attribute name="accession" type="java.lang.String"/>
    <attribute name="url" type="java.lang.String"/>
    <collection name="submissions" referenced-type="Submission" reverse-reference="databaseRecords"/>
  </class>

  <class name="ResultFile" is-interface="true">
    <attribute name="type" type="java.lang.String"/>
    <attribute name="name" type="java.lang.String"/>
    <attribute name="url" type="java.lang.String"/>
    <reference name="submission" referenced-type="Submission" reverse-reference="resultFiles"/>
  </class>

  <class name="Protocol"  
    is-interface="true">
    <attribute name="name" type="java.lang.String" />
    <attribute name="description" type="java.lang.String" />
    <attribute name="type" type="java.lang.String" />
    <attribute name="url" type="java.lang.String" />
    <attribute name="wikiLink" type="java.lang.String" />
    <attribute name="version" type="java.lang.Integer" />
    <collection name="submissions"
      referenced-type="Submission"
      reverse-reference="protocols" />
    <collection name="appliedProtocols"
      referenced-type="AppliedProtocol"
      reverse-reference="protocol" />
  </class>

  <class name="AppliedProtocol"
    is-interface="true">
    <attribute name="step" type="java.lang.Integer" />
    <attribute name="name" type="java.lang.String" />
    <!-- parameter values 
    <attribute name="label" type="java.lang.String" />
-->
    <reference name="protocol"
      referenced-type="Protocol"
      reverse-reference="appliedProtocols" />
    <reference name="submission"
      referenced-type="Submission"
      reverse-reference="appliedProtocols" />
    <collection name="inputs"
      referenced-type="SubmissionData"
      reverse-reference="nextAppliedProtocols" />
    <collection name="outputs"
      referenced-type="SubmissionData"
      reverse-reference="previousAppliedProtocols" />
  </class>

  <class name="SubmissionData"
    is-interface="true">
    <attribute name="name" type="java.lang.String" />
    <attribute name="type" type="java.lang.String" />
    <attribute name="value" type="java.lang.String" />
    <collection name="dataAttributes"
      referenced-type="SubmissionDataAttribute"
      reverse-reference="submissionData" />
    <collection name="features"
      referenced-type="LocatedSequenceFeature" />
    <collection name="nextAppliedProtocols"
      referenced-type="AppliedProtocol"
      reverse-reference="inputs" />
    <collection name="previousAppliedProtocols"
      referenced-type="AppliedProtocol"
      reverse-reference="outputs" />
    <reference name="submission"
      referenced-type="Submission"
      reverse-reference="submissionData" />
  </class>

  <class name="SubmissionDataAttribute"
    is-interface="true">
    <attribute name="name" type="java.lang.String" />
    <attribute name="value" type="java.lang.String" />
    <attribute name="type" type="java.lang.String" />
    <reference name="submissionData"
      referenced-type="SubmissionData"
      reverse-reference="dataAttributes" />
  </class>

  <class name="SubmissionProperty" is-interface="true">
    <attribute name="name" type="java.lang.String"/>
    <attribute name="type" type="java.lang.String"/>
    <attribute name="wikiLink" type="java.lang.String"/>
    <collection name="submissions" referenced-type="Submission" reverse-reference="properties" />
  </class>

  <class name="CellLine" extends="SubmissionProperty" is-interface="true">
    <attribute name="sex" type="java.lang.String"/>
    <attribute name="description" type="java.lang.String"/>
    <attribute name="cellType" type="java.lang.String"/>
    <attribute name="tissue" type="java.lang.String"/>
    <attribute name="species" type="java.lang.String"/>
    <attribute name="targetName" type="java.lang.String"/>
    <reference name="target" referenced-type="Gene"/>
  </class>

  <class name="Strain" extends="SubmissionProperty" is-interface="true">
    <attribute name="species" type="java.lang.String"/>
    <attribute name="source" type="java.lang.String"/>
    <attribute name="description" type="java.lang.String"/>
    <attribute name="name" type="java.lang.String"/>
    <attribute name="fullName" type="java.lang.String"/>
    <attribute name="reference" type="java.lang.String"/>
    <attribute name="targetName" type="java.lang.String"/>
    <reference name="target" referenced-type="Gene"/>
  </class>
  
  <class name="Tissue" extends="SubmissionProperty" is-interface="true">
    <attribute name="species" type="java.lang.String"/>
    <attribute name="sex" type="java.lang.String"/>
    <attribute name="organismPart" type="java.lang.String"/>
  </class>
  
  <class name="DevelopmentalStage" extends="SubmissionProperty" is-interface="true">
    <attribute name="sex" type="java.lang.String"/>
    <collection name="ontologyTerms" referenced-type="OntologyTerm"/>
  </class>
  
  <class name="Antibody" extends="SubmissionProperty" is-interface="true">
    <attribute name="hostOrganism" type="java.lang.String"/>
    <attribute name="targetName" type="java.lang.String"/>
    <attribute name="antigen" type="java.lang.String"/>
    <reference name="target" referenced-type="Gene"/>
  </class>

  <class name="Array" extends="SubmissionProperty" is-interface="true">
    <attribute name="platform" type="java.lang.String"/>
    <attribute name="resolution" type="java.lang.String"/>
    <attribute name="genome" type="java.lang.String"/>
  </class>

  <class name="GrowthTemperature" extends="SubmissionProperty" is-interface="true">
  </class>
  
</classes>
