
<project name="${mine-dir}-sitemap" default="default" basedir=".">
  
  <description>represents the production objectstore and the model therein</description>
  <import file="../../imbuild/task.xml"/>
  <import file="../../imbuild/library.xml"/>



  <target name="-init-generate-sitemap"
          depends="init, -init-deps, -init-task-xml, -init-jar, -init-properties, -set-sitemap-output"/>

  <target name="-set-sitemap-output" unless="sitemap.output">
    <!-- include everything by default -->
    <property name="sitemap.output" value="${dist.dir}"/>
  </target>

  <target name="generate-sitemap" depends="-init-generate-sitemap">
    <taskdef name="generate-sitemap" classname="org.intermine.bio.util.SiteMapTask">
      <classpath refid="task.class.path"/>
    </taskdef>
    <generate-sitemap objectStore="${objectstore.name}"
                  outputFile="${sitemap.output}/sitemap">
    </generate-sitemap>
    <!-- We need a better way to zip the files and make sure it works with SiteMapTask file.exists() code
    <gzip src="${dist.dir}/sitemap180454gene.xml" destfile="${dist.dir}/sitemap180454gene.xml.gz"/>
    <gzip src="${dist.dir}/sitemap180454protein.xml" destfile="${dist.dir}/sitemap180454protein.xml.gz"/>
    <gzip src="${dist.dir}/sitemap7227gene.xml" destfile="${dist.dir}/sitemap7227gene.xml.gz"/>
    <gzip src="${dist.dir}/sitemap7227protein.xml" destfile="${dist.dir}/sitemap7227protein.xml.gz"/>
    <gzip src="${dist.dir}/sitemap7237gene.xml" destfile="${dist.dir}/sitemap7237gene.xml.gz"/>
    <gzip src="${dist.dir}/sitemap7237protein.xml" destfile="${dist.dir}/sitemap7237protein.xml.gz"/>
    <gzip src="${dist.dir}/sitemap.xml" destfile="${dist.dir}/sitemap.xml.gz"/>
   
    <delete file="${dist.dir}/sitemap180454gene.xml"/>
	<delete file="${dist.dir}/sitemap180454protein.xml"/>
	<delete file="${dist.dir}/sitemap7227gene.xml"/>
	<delete file="${dist.dir}/sitemap7227protein.xml"/>
	<delete file="${dist.dir}/sitemap7237gene.xml"/>
	<delete file="${dist.dir}/sitemap7237protein.xml"/>
	<delete file="${dist.dir}/sitemap.xml"/>
    -->
  </target>

  <target name="default" depends="generate-sitemap"/>

  <target name="do-jar" depends="generate-sitemap"/>

</project>
